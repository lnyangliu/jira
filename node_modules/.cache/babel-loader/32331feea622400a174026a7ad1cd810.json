{"ast":null,"code":"const localStorageKey = '__auth_provider_token__';\nconst apiUrl = process.env.REACT_APP_API_URL;\nexport const getToken = () => window.localStorage.getItem(localStorageKey);\nexport const handleUserResponse = ({\n  user\n}) => {\n  window.localStorage.setItem(localStorageKey, user.token || '');\n  return user;\n};\nexport const login = async data => {\n  const response = await fetch(`${apiUrl}/login`, {\n    method: 'POST',\n    headers: {\n      \"content-type\": \"application/json; charset=utf-8\"\n    },\n    body: JSON.stringify(data)\n  });\n\n  if (response.ok) {\n    return handleUserResponse(await response.json());\n  } else {\n    return Promise.reject(data);\n  }\n};\nexport const register = data => {\n  return fetch(`${apiUrl}/register`, {\n    method: 'POST',\n    headers: {\n      \"content-type\": \"application/json; charset=utf-8\"\n    },\n    body: JSON.stringify(data)\n  }).then(async response => {\n    if (response.ok) {\n      return handleUserResponse(await response.json());\n    } else {\n      return Promise.reject(data);\n    }\n  });\n};\nexport const logout = async () => window.localStorage.removeItem(localStorageKey);","map":{"version":3,"sources":["/Users/liuyang/Documents/yideng/jira/src/auth-provider.ts"],"names":["localStorageKey","apiUrl","process","env","REACT_APP_API_URL","getToken","window","localStorage","getItem","handleUserResponse","user","setItem","token","login","data","response","fetch","method","headers","body","JSON","stringify","ok","json","Promise","reject","register","then","logout","removeItem"],"mappings":"AAEA,MAAMA,eAAe,GAAG,yBAAxB;AAEA,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,iBAA3B;AAEA,OAAO,MAAMC,QAAQ,GAAG,MAAMC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BR,eAA5B,CAAvB;AAEP,OAAO,MAAMS,kBAAkB,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAA0B;AACxDJ,EAAAA,MAAM,CAACC,YAAP,CAAoBI,OAApB,CAA4BX,eAA5B,EAA6CU,IAAI,CAACE,KAAL,IAAc,EAA3D;AACA,SAAOF,IAAP;AACH,CAHM;AAKP,OAAO,MAAMG,KAAK,GAAG,MAAOC,IAAP,IAAsD;AACvE,QAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEf,MAAO,QAAX,EAAoB;AAC5CgB,IAAAA,MAAM,EAAE,MADoC;AAE5CC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAFmC;AAK5CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeP,IAAf;AALsC,GAApB,CAA5B;;AAOA,MAAIC,QAAQ,CAACO,EAAb,EAAiB;AACb,WAAOb,kBAAkB,CAAC,MAAMM,QAAQ,CAACQ,IAAT,EAAP,CAAzB;AACH,GAFD,MAEO;AACH,WAAOC,OAAO,CAACC,MAAR,CAAeX,IAAf,CAAP;AACH;AACJ,CAbM;AAcP,OAAO,MAAMY,QAAQ,GAAIZ,IAAD,IAAgD;AACpE,SAAOE,KAAK,CAAE,GAAEf,MAAO,WAAX,EAAuB;AAC/BgB,IAAAA,MAAM,EAAE,MADuB;AAE/BC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAFsB;AAK/BC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeP,IAAf;AALyB,GAAvB,CAAL,CAMJa,IANI,CAMC,MAAOZ,QAAP,IAA8B;AAClC,QAAIA,QAAQ,CAACO,EAAb,EAAiB;AACb,aAAOb,kBAAkB,CAAC,MAAMM,QAAQ,CAACQ,IAAT,EAAP,CAAzB;AACH,KAFD,MAEO;AACH,aAAOC,OAAO,CAACC,MAAR,CAAeX,IAAf,CAAP;AACH;AACJ,GAZM,CAAP;AAaH,CAdM;AAgBP,OAAO,MAAMc,MAAM,GAAG,YAAYtB,MAAM,CAACC,YAAP,CAAoBsB,UAApB,CAA+B7B,eAA/B,CAA3B","sourcesContent":["import {User} from 'screens/project-list/search-panel'\n\nconst localStorageKey = '__auth_provider_token__'\n\nconst apiUrl = process.env.REACT_APP_API_URL\n\nexport const getToken = () => window.localStorage.getItem(localStorageKey)\n\nexport const handleUserResponse = ({user}: {user: User}) => {\n    window.localStorage.setItem(localStorageKey, user.token || '')\n    return user;\n}\n\nexport const login = async (data: {username: string, password: string}) => {\n    const response = await fetch(`${apiUrl}/login`, {\n        method: 'POST',\n        headers: {\n            \"content-type\": \"application/json; charset=utf-8\"\n        },\n        body: JSON.stringify(data)\n    })\n    if (response.ok) {\n        return handleUserResponse(await response.json())\n    } else {\n        return Promise.reject(data)\n    }\n}\nexport const register = (data: {username: string, password: string}) => {\n    return fetch(`${apiUrl}/register`, {\n        method: 'POST',\n        headers: {\n            \"content-type\": \"application/json; charset=utf-8\"\n        },\n        body: JSON.stringify(data)\n    }).then(async (response: Response) => {\n        if (response.ok) {\n            return handleUserResponse(await response.json())\n        } else {\n            return Promise.reject(data)\n        }\n    })\n}\n\nexport const logout = async () => window.localStorage.removeItem(localStorageKey)"]},"metadata":{},"sourceType":"module"}