{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getFocusNodeList = getFocusNodeList;\nexports.saveLastFocusNode = saveLastFocusNode;\nexports.clearLastFocusNode = clearLastFocusNode;\nexports.backLastFocusNode = backLastFocusNode;\nexports.limitTabRange = limitTabRange;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _isVisible = _interopRequireDefault(require(\"./isVisible\"));\n\nfunction focusable(node) {\n  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if ((0, _isVisible.default)(node)) {\n    var nodeName = node.nodeName.toLowerCase();\n    var isFocusableElement = // Focusable element\n    ['input', 'select', 'textarea', 'button'].includes(nodeName) || // Editable element\n    node.isContentEditable || nodeName === 'a' && !!node.getAttribute('href'); // Get tabIndex\n\n    var tabIndexAttr = node.getAttribute('tabindex');\n    var tabIndexNum = Number(tabIndexAttr); // Parse as number if validate\n\n    var tabIndex = null;\n\n    if (tabIndexAttr && !Number.isNaN(tabIndexNum)) {\n      tabIndex = tabIndexNum;\n    } else if (isFocusableElement && tabIndex === null) {\n      tabIndex = 0;\n    } // Block focusable if disabled\n\n\n    if (isFocusableElement && node.disabled) {\n      tabIndex = null;\n    }\n\n    return tabIndex !== null && (tabIndex >= 0 || includePositive && tabIndex < 0);\n  }\n\n  return false;\n}\n\nfunction getFocusNodeList(node) {\n  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var res = (0, _toConsumableArray2.default)(node.querySelectorAll('*')).filter(function (child) {\n    return focusable(child, includePositive);\n  });\n\n  if (focusable(node, includePositive)) {\n    res.unshift(node);\n  }\n\n  return res;\n}\n\nvar lastFocusElement = null;\n/** @deprecated Do not use since this may failed when used in async */\n\nfunction saveLastFocusNode() {\n  lastFocusElement = document.activeElement;\n}\n/** @deprecated Do not use since this may failed when used in async */\n\n\nfunction clearLastFocusNode() {\n  lastFocusElement = null;\n}\n/** @deprecated Do not use since this may failed when used in async */\n\n\nfunction backLastFocusNode() {\n  if (lastFocusElement) {\n    try {\n      // 元素可能已经被移动了\n      lastFocusElement.focus();\n      /* eslint-disable no-empty */\n    } catch (e) {// empty\n    }\n    /* eslint-enable no-empty */\n\n  }\n}\n\nfunction limitTabRange(node, e) {\n  if (e.keyCode === 9) {\n    var tabNodeList = getFocusNodeList(node);\n    var lastTabNode = tabNodeList[e.shiftKey ? 0 : tabNodeList.length - 1];\n    var leavingTab = lastTabNode === document.activeElement || node === document.activeElement;\n\n    if (leavingTab) {\n      var target = tabNodeList[e.shiftKey ? tabNodeList.length - 1 : 0];\n      target.focus();\n      e.preventDefault();\n    }\n  }\n}","map":{"version":3,"sources":["/Users/liuyang/Documents/yideng/jira/node_modules/rc-util/lib/Dom/focus.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","getFocusNodeList","saveLastFocusNode","clearLastFocusNode","backLastFocusNode","limitTabRange","_toConsumableArray2","_isVisible","focusable","node","includePositive","arguments","length","undefined","default","nodeName","toLowerCase","isFocusableElement","includes","isContentEditable","getAttribute","tabIndexAttr","tabIndexNum","Number","tabIndex","isNaN","disabled","res","querySelectorAll","filter","child","unshift","lastFocusElement","document","activeElement","focus","e","keyCode","tabNodeList","lastTabNode","shiftKey","leavingTab","target","preventDefault"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getFocusNodeList = getFocusNodeList;\nexports.saveLastFocusNode = saveLastFocusNode;\nexports.clearLastFocusNode = clearLastFocusNode;\nexports.backLastFocusNode = backLastFocusNode;\nexports.limitTabRange = limitTabRange;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _isVisible = _interopRequireDefault(require(\"./isVisible\"));\n\nfunction focusable(node) {\n  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if ((0, _isVisible.default)(node)) {\n    var nodeName = node.nodeName.toLowerCase();\n    var isFocusableElement = // Focusable element\n    ['input', 'select', 'textarea', 'button'].includes(nodeName) || // Editable element\n    node.isContentEditable || nodeName === 'a' && !!node.getAttribute('href'); // Get tabIndex\n\n    var tabIndexAttr = node.getAttribute('tabindex');\n    var tabIndexNum = Number(tabIndexAttr); // Parse as number if validate\n\n    var tabIndex = null;\n\n    if (tabIndexAttr && !Number.isNaN(tabIndexNum)) {\n      tabIndex = tabIndexNum;\n    } else if (isFocusableElement && tabIndex === null) {\n      tabIndex = 0;\n    } // Block focusable if disabled\n\n\n    if (isFocusableElement && node.disabled) {\n      tabIndex = null;\n    }\n\n    return tabIndex !== null && (tabIndex >= 0 || includePositive && tabIndex < 0);\n  }\n\n  return false;\n}\n\nfunction getFocusNodeList(node) {\n  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var res = (0, _toConsumableArray2.default)(node.querySelectorAll('*')).filter(function (child) {\n    return focusable(child, includePositive);\n  });\n\n  if (focusable(node, includePositive)) {\n    res.unshift(node);\n  }\n\n  return res;\n}\n\nvar lastFocusElement = null;\n/** @deprecated Do not use since this may failed when used in async */\n\nfunction saveLastFocusNode() {\n  lastFocusElement = document.activeElement;\n}\n/** @deprecated Do not use since this may failed when used in async */\n\n\nfunction clearLastFocusNode() {\n  lastFocusElement = null;\n}\n/** @deprecated Do not use since this may failed when used in async */\n\n\nfunction backLastFocusNode() {\n  if (lastFocusElement) {\n    try {\n      // 元素可能已经被移动了\n      lastFocusElement.focus();\n      /* eslint-disable no-empty */\n    } catch (e) {// empty\n    }\n    /* eslint-enable no-empty */\n\n  }\n}\n\nfunction limitTabRange(node, e) {\n  if (e.keyCode === 9) {\n    var tabNodeList = getFocusNodeList(node);\n    var lastTabNode = tabNodeList[e.shiftKey ? 0 : tabNodeList.length - 1];\n    var leavingTab = lastTabNode === document.activeElement || node === document.activeElement;\n\n    if (leavingTab) {\n      var target = tabNodeList[e.shiftKey ? tabNodeList.length - 1 : 0];\n      target.focus();\n      e.preventDefault();\n    }\n  }\n}"]},"metadata":{},"sourceType":"script"}